# hikkake_bot ファイル階層

`hikkake_bot` モジュールのファイルおよびディレクトリ構造です。機能の分離、保守性、拡張性を考慮して設計されています。

```
hikkake_bot/
├── 📂 commands/
│   └── 📜 setup.js
├── 📂 handlers/
│   ├── 📂 buttons/
│   │   ├── 📜 staffCount.js
│   │   ├── 📜 flatArrival.js
│   │   ├── 📜 hikkakeConfirm.js
│   │   ├── 📜 hikkakeFail.js
│   │   ├── 📜 hikkakePlan.js
│   │   └── 📜 leaveGuest.js
│   ├── 📂 modals/
│   │   ├── 📜 staffCountModal.js
│   │   └── 📜 hikkakePlanModal.js
│   └── 📂 selects/
│       └── 📜 targetHikkakeSelect.js
├── 📂 utils/
│   ├── 📜 dataManager.js
│   ├── 📜 embedBuilder.js
│   └── 📜 threadLogger.js
├── 📜 index.js
├── 📜 constants.js
├── 📜 問題点.md
└── 📜 ひっかけ仕様書.md
```

---

### ディレクトリとファイルの詳細

#### 📂 `commands/`
スラッシュコマンドの定義ファイルを格納します。

- **📜 `setup.js`**
  - `/引っ掛け掲示板設置` コマンドの定義と実行ロジックを管理します。
  - 掲示板の初期メッセージ（埋め込みとボタン）を送信します。

#### 📂 `handlers/`
Discordのインタラクション（ボタン、モーダル、セレクトメニュー）を処理するハンドラをコンポーネントの種類ごとに整理して格納します。

- **📂 `buttons/`**: ボタンインタラクションのハンドラ
    - **📜 `staffCount.js`**: 「プラカマスタッフ数入力」ボタンの処理。モーダルを開きます。
    - **📜 `flatArrival.js`**: 「ふらっと来た」ボタンの処理。
    - **📜 `hikkakeConfirm.js`**: 「ひっかけ確定」ボタンの処理。
    - **📜 `hikkakeFail.js`**: 「ひっかけ失敗」ボタンの処理。
    - **📜 `hikkakePlan.js`**: 「ひっかけ予定」ボタンの処理。モーダルを開きます。
    - **📜 `leaveGuest.js`**: 「退店」ボタンの処理。

- **📂 `modals/`**: モーダル送信のハンドラ
    - **📜 `staffCountModal.js`**: スタッフ数設定モーダルの入力値を処理し、データを更新します。
    - **📜 `hikkakePlanModal.js`**: ひっかけ予定モーダルの入力値（客数、プラ/カマ減少数、本数）を処理します。

- **📂 `selects/`**: セレクトメニューインタラクションのハンドラ
    - **📜 `targetHikkakeSelect.js`**: 「ひっかけ確定」「失敗」「退店」時に、対象となる「ひっかけ予定」を選択するメニューの処理をします。

#### 📂 `utils/`
ボット全体で再利用される補助的な機能やヘルパー関数を格納します。

- **📜 `dataManager.js`**
  - ひっかけの状態、スタッフ数などのデータを管理します。（例: JSONファイルやデータベースとのやり取り）
- **📜 `embedBuilder.js`**
  - 「店内状況」や「引っ掛け一覧」などの埋め込みメッセージを生成するロジックを管理します。
- **📜 `threadLogger.js`**
  - 操作ログを特定のスレッドに記録するための関数を管理します。

#### 📜 `index.js`
`hikkake_bot` モジュールのエントリポイントです。
- `handlers` フォルダ内の各ハンドラを読み込み、`customId` に応じて処理を振り分ける単一のオブジェクトとしてエクスポートします。
- これにより、メインのボット (`events/interactionCreate.js`) はこのモジュールをシンプルに利用できます。

#### 📜 `constants.js`
ボタンやモーダルの `customId`、絵文字、設定値などの定数を一元管理します。

#### 📜 `問題点.md`
（既存ファイル）コードベースの問題点と改善案を記述したドキュメント。

#### 📜 `ひっかけ仕様書.md`
（既存ファイル）`hikkake_bot` の機能仕様を記述したドキュメント。